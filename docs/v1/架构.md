project/
│
├── app/
│   ├── __init__.py                     # create_app 入口，集中注册路由/依赖/中间件
│   ├── api/                            # HTTP 控制层，直接映射业务场景
│   │   ├── user/
│   │   │   ├── auth.py                 # 登录 / 注册 / JWT 刷新
│   │   │   ├── captcha.py              # 图形验证码生成与校验
│   │   │   ├── follow.py               # 关注、取关、粉丝/关注列表
│   │   │   └── profile.py              # 个人资料、头像、统计信息
│   │   ├── video/
│   │   │   ├── video.py                # 首页 feed、推荐、详情、搜索
│   │   │   └── upload.py               # 视频 + 封面上传，落地本地存储
│   │   ├── comment/
│   │   │   └── comment.py              # 评论 / 子评论 CRUD + 点赞数聚合
│   │   ├── interaction/
│   │   │   └── interaction.py          # 点赞 / 收藏状态切换与查询
│   │   ├── history/                    # 观看历史 API 占位（与 analytics 共享模型）
│   │   └── analytics/
│   │       └── analytics.py            # 观看历史读取、热门视频、观看日志
│   ├── core/
│   │   ├── __init__.py
│   │   └── config.py                   # Pydantic Settings，读取 .env，导出 settings 对象
│   ├── dependencies/
│   │   ├── __init__.py
│   │   └── user.py                     # get_current_user、get_db 等 FastAPI Depends
│   ├── db/
│   │   ├── __init__.py
│   │   ├── mysql.py                    # AsyncMy + SQLAlchemy engine/session 管理
│   │   ├── mongodb.py                  # Motor 客户端工厂
│   │   └── redis.py                    # aioredis 连接池
│   ├── models/
│   │   ├── mysql/                      # SQLAlchemy ORM：user/video/comment/like/... 等表
│   │   ├── mongodb/                    # Mongo 文档模型（评论扩展、用户行为）
│   │   └── redis/                      # Redis key schema（计数/缓存 namespace）
│   ├── schemas/
│   │   ├── response.py                 # 统一响应体（成功/失败包装）
│   │   ├── video/、user/、comment/…     # Pydantic DTO，和 API / Service 入参出参对应
│   │   └── interaction/history         # 点赞/收藏/历史记录结构
│   ├── crud/
│   │   ├── video.py、user/、comment/…  # Repository 层，封装 DB/Mongo/Redis 查询
│   │   └── interaction/like.py 等       # 点赞/收藏数据访问
│   ├── services/
│   │   ├── video/video.py              # 上传、推荐、详情、互动统计聚合
│   │   ├── user/follow_service.py      # 关注关系、粉丝统计、互关判断
│   │   ├── user/profile_service.py     # 用户主页聚合信息
│   │   ├── interaction/interaction.py  # 点赞/收藏业务逻辑与幂等控制
│   │   ├── comment/comment.py          # 评论审核、父子评论关联
│   │   ├── analytics/analytics.py      # 观看历史、热门榜单、观看日志
│   │   └── history/                    # 占位，复用 analytics 模块的数据
│   ├── storage/
│   │   ├── base.py                     # 抽象存储接口（save/delete）
│   │   ├── local.py                    # 将上传的媒体文件落地到本地磁盘
│   │   └── aliyun_oss.py               # OSS 适配器（当前示例未启用，可按需接入）
│   ├── tasks/
│   │   ├── video_tasks.py              # 视频处理、异步通知的 Celery/APShell 任务
│   │   └── notify_tasks.py             # 评论提醒、系统消息（占位）
│   ├── utils/
│   │   ├── encrypt/                    # 对称/非对称加解密、验证码图片
│   │   ├── file_validator.py           # 上传文件尺寸/格式校验
│   │   ├── security.py                 # 密码哈希、JWT 编解码
│   │   ├── response.py                 # ResponseSchema 工具
│   │   └── wangyi/email_send.py        # 网易邮箱 SMTP 发信
│   └── middlewares/
│       ├── logging.py                  # 请求日志
│       ├── cors.py                     # CORS 配置
│       ├── exception.py                # 统一异常处理
│       ├── trace.py                    # 简单请求 Trace ID
│       └── anti_scrape.py              # UA/速率初步防护
│
├── alembic/
│   ├── env.py                          # 将 SQLAlchemy metadata 注入迁移环境
│   ├── script.py.mako                  # 迁移脚本模板
│   └── versions/                       # 版本脚本（示例：6dcf98062aa1_init.py）
├── alembic.ini                         # Alembic CLI 配置
├── docs/                               # 说明文档（架构/配置/规范）
│   └── v1/
│       ├── 架构.md
│       ├── 项目配置.md
│       ├── 软件说明.md
│       ├── 需规.md
│       └── alembic使用流程.md
├── media/                              # 运行期生成的媒体文件（avatars/covers/videos）
├── static/                             # 对外静态资源（默认头像、前端静态页等）
├── SystemScript/                       # 预留系统脚本目录（当前为空，可放 init 脚本）
├── test/                               # MySQL/Mongo/Redis 连接与示例测试
├── requirements.txt                    # Python 依赖（FastAPI/SQLAlchemy/Motor/Celery...）
├── main.py                             # Uvicorn 入口，运行 FastAPI app
├── run.sh                              # 本地启动脚本：kill port + python main.py
├── .gitignore                          # Git 忽略配置
└── .env                                # 运行期环境变量（未纳入版本控制）

---

## 业务映射提示
1. **账号 & 关系链**：`app/api/user/*` + `services/user/` 覆盖登录、资料、关注，直接支撑用户系统。
2. **媒体上传/点播**：`api/video/`、`services/video/`、`storage/`、`media/` 串起上传、校验、落地与访问地址生成。
3. **互动闭环**：`api/comment/` 与 `api/interaction/` 结合 `services/comment|interaction`，提供评论和点赞/收藏的状态流转。
4. **行为采集与分析**：`api/analytics/` + `services/analytics/` 记录观看日志、拉取热门榜单，是云媒体运营指标的来源。
5. **异步扩展能力**：`tasks/video_tasks.py`、`notify_tasks.py` 为转码、消息推送等耗时操作提供执行位；后续可与 Celery/Redis 对接。
