project/
│
├── app/                                # 应用主目录（核心业务逻辑）
│   ├── __init__.py                     # FastAPI app 初始化位置（可选封装 create_app）

│   ├── api/                            # 接口路由层（API 层，控制器）
│   │   ├── __init__.py                 # 自动加载所有路由模块
│   │   ├── user/                       # 用户领域 API
│   │   │   ├── auth.py                 # 登录、注册、JWT
│   │   │   ├── captcha.py              # 验证码
│   │   │   └── profile.py              # 个人主页接口（收藏/历史/上传等）
│   │   ├── video/                      # 视频相关接口
│   │   │   ├── video.py                # 视频播放、详情页等
│   │   │   └── upload.py               # 上传接口（本地/云 OSS）
│   │   ├── comment/                    # 评论系统 API
│   │   │   └── comment.py              # 评论、回复接口（支持嵌套）
│   │   ├── interaction/                # 用户交互（点赞、收藏等）
│   │   │   └── interaction.py
│   │   └── history/                    # 观看历史接口
│   │       └── history.py

│   ├── core/                           # 核心配置模块
│   │   ├── __init__.py                 # 核心配置初始化
│   │   ├── config.py                   # 应用配置（环境变量、数据库等）
│   │   ├── db.py                       # 数据库连接配置
│   │   ├── redis.py                    # Redis连接配置
│   │   └── security.py                 # 安全相关（JWT、密码等）

│   ├── dependencies/                   # 依赖注入模块
│   │   ├── __init__.py                 # 依赖注入初始化
│   │   └── user.py                     # 用户相关依赖（获取当前用户等）

│   ├── models/                         # 数据模型层（SQLAlchemy ORM）
│   │   ├── __init__.py                 # 聚合导入所有模型
│   │   ├── base.py                     # Base = declarative_base()
│   │   ├── user/                       # 用户相关模型
│   │   ├── video/                      # 视频模块模型
│   │   ├── comment/                    # 评论模块模型
│   │   ├── like.py                     # 点赞
│   │   ├── collection.py               # 收藏模型
│   │   └── watch_history.py            # 历史记录模型

│   ├── schemas/                        # 请求响应数据结构（DTO）
│   │   ├── __init__.py
│   │   ├── user/                       # 用户登录、注册、Token 响应结构
│   │   │   ├── auth.py
│   │   │   └── profile.py
│   │   ├── video/                      # 视频请求与响应字段结构
│   │   │   └── video.py
│   │   ├── comment/                    # 评论 / 回复结构体
│   │   │   └── comment.py
│   │   ├── interaction/                # 点赞 / 收藏数据结构
│   │   │   └── interaction.py
│   │   └── history/                    # 观看历史请求体 / 响应体
│   │       └── history.py

│   ├── crud/                           # 数据访问层（Repository 层）
│   │   ├── __init__.py
│   │   ├── user/                       # 用户相关数据操作
│   │   │   ├── auth.py
│   │   │   └── user.py
│   │   ├── video/                      # 视频数据访问
│   │   │   └── video.py
│   │   ├── comment/                    # 评论数据增删查改
│   │   │   └── comment.py
│   │   ├── interaction/                # 点赞 / 收藏
│   │   │   ├── like.py
│   │   │   └── collection.py
│   │   └── history/                    # 历史记录
│   │       └── watch_history.py

│   ├── services/                       # 服务层（业务逻辑 / Use Case）
│   │   ├── __init__.py
│   │   ├── video/                      # 视频业务（上传、权限、转码等）
│   │   │   └── video_service.py
│   │   ├── comment/                    # 评论业务逻辑
│   │   │   └── comment_service.py
│   │   ├── interaction/                # 点赞、收藏等行为逻辑
│   │   │   └── interaction_service.py
│   │   ├── history/                    # 历史记录逻辑
│   │   │   └── history_service.py
│   │   └── user/                       # 用户聚合服务（主页统计、头像管理等）
│   │       └── profile_service.py

│   ├── middlewares/                   # 中间件模块
│   │   ├── __init__.py
│   │   ├── logging.py                 # 请求日志中间件
│   │   ├── cors.py                    # 跨域中间件
│   │   ├── exception_handler.py       # 全局异常处理
│   │   ├── trace.py                   # 请求追踪（支持分布式链路追踪）
│   │   └── anti_scrape.py             # 防爬虫中间件

│   ├── exceptions/                    # 应用级异常定义
│   │   ├── __init__.py
│   │   ├── base.py                    # 自定义异常基类
│   │   ├── user_exceptions.py         # 用户模块异常
│   │   ├── video_exceptions.py        # 视频模块异常
│   │   └── common_exceptions.py       # 通用异常（参数错误等）

│   ├── utils/                         # 工具函数（独立于业务逻辑）
│   │   ├── __init__.py
│   │   ├── encrypt/                   # 加解密工具
│   │   │   ├── encrypt.py
│   │   │   └── image_code.py         # 图像验证码生成
│   │   ├── mailer/                    # 邮件发送（支持网易邮箱）
│   │   │   └── email_send.py
│   │   ├── security.py                # 密码加密、JWT 编解码
│   │   ├── video_utils.py             # 视频转码、截图等处理工具
│   │   ├── file_validator.py          # 文件大小、类型合法性校验
│   │   ├── user_agent.py              # 请求头解析、防爬 UA 检测
│   │   └── response_wrapper.py        # 接口返回格式统一封装

│   ├── storage/                       # 文件存储抽象层（可插拔后端）
│   │   ├── __init__.py
│   │   ├── base.py                    # 定义统一存储接口
│   │   ├── local.py                   # 本地文件存储实现
│   │   └── aliyun_oss.py              # 阿里云 OSS 接入（可拓展至 S3）

│   └── tasks/                         # 异步任务模块（Celery / APScheduler）
│       ├── __init__.py
│       ├── video_tasks.py             # 视频处理（转码、封面提取等）
│       └── notify_tasks.py            # 评论提醒、消息推送等

├── media/                             # 本地静态资源根目录（统一存储）
│   ├── uploads/                       # 用户上传的文件（临时 + 原始）
│   ├── videos/                        # 转码后的视频文件
│   ├── covers/                        # 视频封面图、截图
│   ├── avatars/                       # 用户头像
│   ├── image/                         # 图片
│   └── temp/                          # 临时文件处理区（上传中/任务中间态）

├── SystemScript/                      # 系统脚本目录
│   ├── init_db.py                     # 数据库初始化脚本
│   └── create_admin.py                # 创建管理员账号脚本

├── main.py                            # 应用入口（创建 FastAPI 实例、挂载中间件路由等）

├── alembic/                           # Alembic 数据库迁移目录
│   ├── versions/                      # 自动生成的版本脚本
│   └── env.py                         # Alembic 环境配置（绑定 metadata）

├── .env                               # 项目环境变量配置
├── alembic.ini                        # Alembic CLI 配置
└── .gitignore                         # Git 忽略规则

